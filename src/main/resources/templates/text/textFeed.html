<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<script defer src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<link rel="stylesheet" href="/css/text/textFeedStyle.css" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<title>텍스트 피드</title>
</head>
<body>
    <th:block th:include="/common/header"></th:block>
    <div class="wrapper">
        <section class="text-feed">
            <div th:if="${session.user != null}" class="text-feed-write-box">
                <div class="profile-pic">
                    <img src="logo1.jpg" alt="Profile Picture" />
                </div>
                <div class="text-feed-write-area">
                    <form action="/textFeedWrite" method="get">
                        <textarea name="text-feed-content" id="text-feed-content" placeholder="오늘 무슨일이 있었나요?(100자)"></textarea>
                        <div class="text-feed-actions">
                            <button  type="submit" class="text-feed-button">작성하기</button>
                        </div>
                    </form>
                </div>
            </div>
            
            <div class="text-feed-posts" id="text-feed-posts">
                <div class="post" th:each="textFeed : ${textFeedList}">
                    <div class="post-profile-pic">
                        <img src="Profile Picture" alt="Profile Picture">
                    </div>
                    <div class="post-content">
                        <p class="text-feed-writer" th:text="${textFeed.textFeedWriter}"></p>
                        <p class="text-feed-content" th:text="${textFeed.textFeedContent}"></p>
                        <div class="post-actions">
                            <i class="fa fa-heart"></i>
                            <i class="fa fa-paper-plane"></i>
                            <i class="fa fa-comment"></i>
                            <span>댓글수</span>
                            <i class="fa fa-ellipsis-h"></i>
                            <div class="post-options">
                                <button><span class="material-icons edit-btn">edit</span></button>
                                <button><span class="material-icons">report_problem</span></button>
                                <button><span class="material-icons">bookmark_border</span></button>
                                <button><span class="material-icons delete-btn">delete_forever</span></button>
                            </div>
                        </div>
                    </div>
                    <div class="comment-section">
                        <textarea placeholder="댓글을 작성해보세요 !"></textarea>
                        <button class="submit-comment">댓글 달기</button>
                        <div class="comments-container">
                            <!-- 댓글들이 여기에 추가됩니다 -->
                        </div>
                    </div>
                </div>
            </div>
            <button th:if="${session.user != null}" id="load-more" class="text-feed-button">더보기</button>
            <button th:if="${session.user == null}" id="login-load-more" class="text-feed-button">
            <a
           		class="nav-link"
                aria-current="page"
                href="/text/textList"
                data-bs-toggle="modal"
                data-bs-target="#loginModal"
                >로그인 후 더보기</a></button>
                
        </section>
    </div>
    <th:block th:include="/common/footer"></th:block>

    <script>
    
    $(document).ready(function() {
        let posts = $('#text-feed-posts .post');
        let numPerPage = 3;
        let currentPage = 1;

        function showPage(page) {
            let start = (page - 1) * numPerPage;
            let end = page * numPerPage;
            posts.slice(start, end).show();
        }

        // 초기 로드 시 첫 번째 페이지를 표시
        showPage(currentPage);

        $('#load-more').click(function() {
            currentPage++;
            showPage(currentPage);
        });

        // 모든 포스트를 숨기고 처음 numPerPage개의 포스트만 표시
        posts.hide();
        showPage(currentPage);
    });
    
    $(".fa-ellipsis-h").click(function() {
        $(this).siblings(".post-options").toggle();
    });
</script>
</body>
</html>